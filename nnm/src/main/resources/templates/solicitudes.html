<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">

<head>
    <meta charset="UTF-8">
    <title>Solicitudes</title>
    <link rel="stylesheet" href="/css/solicitudes.css">
</head>

<body>
    <div class="contenedor-principal">

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="usuario-info">
                <div class="avatar">ðŸ‘¤</div>
                <div class="usuario-nombre"><span th:text="${username}">Nombre Usuario</span></div>
                <p class="rol">Propietario</p>
            </div>

            <nav class="menu">
                <a th:href="@{/home}" class="menu-item">Mis Propiedades</a>
                <a th:href="@{/calendario}" class="menu-item">Calendario</a>
                <a th:href="@{/confirmacionReserva/{username}(username=${username})}"
                    class="menu-item activo">Solicitudes</a>
            </nav>
        </aside>

        <!-- Zona central -->
        <main class="zona-solicitudes">

            <!-- Lista -->
            <section class="lista-solicitudes">
                <h2>Solicitudes (<span th:text="${solicitudes.size()}">0</span>)</h2>

                <!-- Sin solicitudes -->
                <div th:if="${#lists.isEmpty(solicitudes)}" class="sin-solicitudes">
                    <p>No tienes solicitudes pendientes por el momento.</p>
                </div>

                <!-- Con solicitudes -->
                <div th:unless="${#lists.isEmpty(solicitudes)}">
                    <ul class="solicitudes">
                        <li class="solicitud-item" th:each="solicitud : ${solicitudes}" th:data-id="${solicitud.id}"
                            th:data-titulo="${solicitud.reserva.inmueble.titulo}"
                            th:data-nombre="${solicitud.reserva.inquilino.username}"
                            th:data-fechainicio="${#temporals.format(solicitud.reserva.fechaInicio, 'dd MMM yyyy')}"
                            th:data-fechafin="${#temporals.format(solicitud.reserva.fechaFin, 'dd MMM yyyy')}"
                            th:data-noches="${solicitud.noches}"
                            th:data-precionoche="${solicitud.reserva.inmueble.precio_noche}"
                            th:data-preciototal="${solicitud.precioTotal}"
                            th:data-img="@{/inmuebles/{id}/foto(id=${solicitud.reserva.inmueble.id})}">

                            <div class="contenido-solicitud">
                                <div class="info-principal">
                                    <strong class="titulo"
                                        th:text="${solicitud.reserva.inmueble.titulo}">TÃ­tulo</strong><br>
                                    <span class="inquilino"
                                        th:text="${solicitud.reserva.inquilino.username}">Inquilino</span><br>
                                    <div class="fechas">
                                        <small
                                            th:text="${#temporals.format(solicitud.reserva.fechaInicio, 'dd MMM')}"></small>
                                        -
                                        <small
                                            th:text="${#temporals.format(solicitud.reserva.fechaFin, 'dd MMM')}"></small>
                                    </div>
                                </div>
                                <small class="fecha-creacion"
                                    th:text="${#temporals.format(solicitud.fechaCreacion, 'dd MMM HH:mm')}"></small>
                            </div>
                        </li>
                    </ul>
                </div>
            </section>

            <!-- Panel de detalle fijo -->
            <section class="detalle-solicitud">
                <div id="detalleContenido" class="detalle-contenido">

                    <!-- Placeholder -->
                    <p id="mensaje-placeholder" class="mensaje-placeholder">Selecciona una solicitud para ver los
                        detalles.</p>

                    <!-- Detalle de la solicitud -->
                    <div id="detalleInfo" class="hidden">
                        <h2 id="mdTitulo"></h2>

                        <div class="img-container">
                            <img id="mdImg" alt="Imagen inmueble">
                        </div>

                        <h3>Detalles de la reserva</h3>
                        <p><strong>Entrada:</strong> <span id="mdFechaInicio"></span></p>
                        <p><strong>Salida:</strong> <span id="mdFechaFin"></span></p>
                        <p><strong>Noches:</strong> <span id="mdNoches"></span></p>

                        <h3>Inquilino</h3>
                        <p id="mdNombre"></p>

                        <h3>Desglose del pago</h3>
                        <ul>
                            <li>Precio/noche: <span id="mdPrecioNoche"></span></li>
                            <li>Total: <strong id="mdPrecioTotal"></strong></li>
                        </ul>

                        <div class="acciones">
                            <form id="formAceptar" method="post" style="display:none;"></form>
                            <button type="submit" form="formAceptar" class="btn-aceptar">Aceptar</button>

                            <form id="formRechazar" method="post" style="display:none;"></form>
                            <button type="submit" form="formRechazar" class="btn-rechazar">Rechazar</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="/js/detallesSolicitudes.js"></script>
</body>

</html>