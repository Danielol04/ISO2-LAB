<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ventana de Pago</title>
<link rel="stylesheet" th:href="@{/css/pago.css}">
</head>
<body>
    
    <form th:action="@{/pago/confirmarPago/{id}(id=${reserva.id})}" method="post">

    <input type="hidden" name="precioTotal" th:value="${reserva.precioTotal}" />

        <div class="container">
            <div class="header">
                <h1>Completa tu reserva</h1>
                <a th:href="@{/home}" class="btn-cancelar">
                    <svg class="icon-svg" viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                    Cancelar
                </a>
            </div>

            <div class="main-grid">
                
                <div class="left-col">
                    
                    <section>
                        <h2 class="section-title">Método de Pago</h2>
                        <div class="card">
                            
                            <label class="payment-option">
                                <div class="payment-icon-wrapper">
                                    <svg class="icon-svg" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                                </div>
                                <div class="payment-info">
                                    <span class="payment-title">Tarjeta de crédito/débito</span>
                                </div>
                                <input type="radio" name="metodoPago" value="TARJETA_CREDITO" checked onclick="mostrarFormulario('TARJETA')">
                            </label>

                            <label class="payment-option">
                                <div class="payment-icon-wrapper" style="color: #003087; background: #e5f1fc;">
                                    <svg class="icon-svg" viewBox="0 0 24 24" style="fill:currentColor; stroke:none;"><path d="M7.076 21.337l.848-5.39h1.378l-1.558 6.643h-3.62c-.37 0-.616-.386-.486-.728.18-.476.305-.79.352-.898.157-.34.46-.527.834-.527h2.25zm13.19-12.067c-.232 2.94-2.127 5.794-5.83 5.794h-2.148c-.407 0-.76.29-.824.707l-1.29 8.164h-3.53l.635-4.03h-.146c-2.43 0-4.053-1.636-3.38-5.908.487-3.08 2.922-5.918 6.447-5.918h1.61c.42 0 .783.3.85.73l.024.155.08-.49c.28-1.745 1.76-3.47 4.226-3.47 2.375 0 3.737 1.635 3.176 4.266z"/></svg>
                                </div>
                                <div class="payment-info">
                                    <span class="payment-title" style="color: #003087; font-weight:800;">PayPal</span>
                                </div>
                                <input type="radio" name="metodoPago" value="PAYPAL" onclick="mostrarFormulario('PAYPAL')">
                            </label>
                        </div>
                    </section>

                    <section id="card-details-wrapper">
                        <h2 class="section-title">Detalles de la Tarjeta</h2>
                        <div class="card p-6 space-y-4">
                            <div class="form-group">
                                <label>Número de tarjeta</label>
                                <div class="input-with-icon">
                                    <input type="text" placeholder="0000 0000 0000 0000" maxlength="19">
                                    <svg class="icon-input" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-col">
                                    <label>Fecha de caducidad</label>
                                    <input type="text" placeholder="MM/AA">
                                </div>
                                <div class="form-col">
                                    <label>CVV</label>
                                    <input type="password" placeholder="123">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Nombre del titular de la tarjeta</label>
                                <input type="text" placeholder="Nombre Apellido">
                            </div>
                        </div>
                    </section>

                    <section id="paypal-details-wrapper" style="display: none;">
                        <h2 class="section-title">Detalles de PayPal</h2>
                        <div class="card paypal-container">
                            
                            <div class="paypal-circle-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor" width="40" height="40">
                                    <path d="M20 7h-7L10 20v2h4l2.5-7h3.5c2.5 0 4-1.5 4-4.5s-1.5-3.5-4-3.5z"/>
                                </svg>
                            </div>
                    
                            <p class="paypal-text">
                                Introduce tu correo electrónico asociado a PayPal para autorizar el pago.
                            </p>
                    
                            <div class="form-group" style="width: 100%; max-width: 400px; text-align: left;">
                                <label style="color:#003087;">Correo Electrónico PayPal</label>
                                <input type="text" name="emailPaypal" placeholder="ejemplo@correo.com" class="paypal-input">
                            </div>
                    
                            <p class="paypal-footer-text">
                                PayPal se encargará de confirmar la transacción de forma segura.
                            </p>
                        </div>
                    </section>

                    <section>
                        <h2 class="section-title">Dirección de Facturación</h2>
                        <div class="card p-6 space-y-4">
                            <div class="form-group">
                                <label>Dirección</label>
                                <input type="text" th:value="${reserva.inmueble.direccion}" readonly class="input-readonly">
                            </div>
                            <div class="form-row">
                                <div class="form-col">
                                    <label>Ciudad</label>
                                    <input type="text" th:value="${reserva.inmueble.localidad}" readonly class="input-readonly">
                                </div>
                                <div class="form-col">
                                    <label>Código Postal</label>
                                    <input type="text" th:value="${reserva.inmueble.codigo_postal}" readonly class="input-readonly">
                                </div>
        </div>
                        </div>
                    </section>
                </div>

                <div class="right-col">
                    <div class="summary-card">
                        <h2 class="section-title" style="margin-top:0">Resumen del Pedido</h2>
                        
                        <div class="summary-row">
                            <span class="text-muted">Estancia (<span th:text="${reserva.noches}"></span> noches)</span>
                            <span class="font-medium" th:text="${reserva.precioTotal} + ' €'"></span>
        </div>
                        <div class="summary-row">
                            <span class="text-muted">Impuestos</span>
                            <span class="font-medium">Incluidos</span>
                        </div>
                        <div class="divider"></div>

                        <div class="total-row">
                            <span class="total-label">Total a Pagar</span>
                            <span class="total-amount" th:text="${reserva.precioTotal} + ' €'">0 €</span>
                        </div>

                        <button type="submit" class="btn-submit">
                            Confirmar Pago
                        </button>

                        <div class="secure-badge">
                            <svg class="icon-svg" style="width:16px; height:16px;" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                            Pago seguro y encriptado
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <script th:src="@{/js/pago.js}"></script>
</body>
</html>